<h1>SplaySpace</h1>

<h2>Players</h2>
<ul id="players"></ul>

<script>
	const playersList = document.getElementById('players');

	const WS_URL = process.env.WS_URL;
	console.info('connecting to', WS_URL);
	const ws = new WebSocket(WS_URL);

	ws.onerror = (event) => console.error('ws error', event);
	ws.onopen = (event) => console.info('ws open', event);
	ws.onclose = (event) => console.warn('ws close', event);

	ws.onmessage = (event) => {
		const { action, connectionId } = JSON.parse(event.data);
		console.log('ws message', action);

		switch (action) {
			case 'arrival':
				const newListItem = document.createElement('LI');
				newListItem.innerText = connectionId;
				newListItem.id = connectionId;
				playersList.appendChild(newListItem);
				break;

			case 'departure':
				const oldListItem = document.getElementById(connectionId);
				playersList.removeChild(oldListItem);
				break;

			default:
				break;
		}
	};
</script>
